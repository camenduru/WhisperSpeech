<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>WhisperSpeech - VQ semantic token extraction evaluation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="WhisperSpeech - VQ semantic token extraction evaluation">
<meta property="og:image" content="https://collabora.github.io/WhisperSpeech/2C. Whisper quantization (semantic token) evaluation_files/figure-html/cell-56-output-2.png">
<meta property="og:site-name" content="WhisperSpeech">
<meta property="og:image:height" content="432">
<meta property="og:image:width" content="567">
<meta name="twitter:title" content="WhisperSpeech - VQ semantic token extraction evaluation">
<meta name="twitter:image" content="https://collabora.github.io/WhisperSpeech/2C. Whisper quantization (semantic token) evaluation_files/figure-html/cell-56-output-2.png">
<meta name="twitter:image-height" content="432">
<meta name="twitter:image-width" content="567">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">WhisperSpeech</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/collabora/WhisperSpeech" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">VQ semantic token extraction evaluation</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">WhisperSpeech</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataset preparation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">I can has speech? What data WhisperSpeech needs?</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#how-whisper-works-with-speech-cut-at-different-lengths" id="toc-how-whisper-works-with-speech-cut-at-different-lengths" class="nav-link active" data-scroll-target="#how-whisper-works-with-speech-cut-at-different-lengths">How Whisper works with speech cut at different lengths</a></li>
  <li><a href="#tests-on-librispeech" id="toc-tests-on-librispeech" class="nav-link" data-scroll-target="#tests-on-librispeech">Tests on LibriSpeech</a>
  <ul>
  <li><a href="#entropy-of-the-token-stream" id="toc-entropy-of-the-token-stream" class="nav-link" data-scroll-target="#entropy-of-the-token-stream">Entropy of the token stream</a></li>
  <li><a href="#word-error-rate-measurements" id="toc-word-error-rate-measurements" class="nav-link" data-scroll-target="#word-error-rate-measurements">Word Error Rate measurements</a>
  <ul class="collapse">
  <li><a href="#vanilla-whisper-models" id="toc-vanilla-whisper-models" class="nav-link" data-scroll-target="#vanilla-whisper-models">Vanilla Whisper models</a></li>
  <li><a href="#quantized-whisper-models" id="toc-quantized-whisper-models" class="nav-link" data-scroll-target="#quantized-whisper-models">Quantized Whisper models</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/collabora/WhisperSpeech/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">VQ semantic token extraction evaluation</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torchaudio</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastprogress <span class="im">import</span> progress_bar, master_bar</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> fastprogress</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pylab <span class="im">as</span> plt</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> IPython</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> whisper</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastcore.script <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> show_chunk(data, i):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    row <span class="op">=</span> data.loc[i]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    snd, sr <span class="op">=</span> torchaudio.load(<span class="st">'/data/librilight/'</span><span class="op">+</span>row[<span class="st">'fname'</span>])</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    IPython.display.display(IPython.display.Audio(snd[<span class="dv">0</span>,<span class="bu">int</span>(row[<span class="st">'tstart'</span>]<span class="op">*</span>sr):<span class="bu">int</span>(row[<span class="st">'tend'</span>]<span class="op">*</span>sr)], rate<span class="op">=</span>sr))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(row[<span class="st">'len'</span>], row[<span class="st">'txt'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test_incremental(model_name, Tmax<span class="op">=</span><span class="dv">15</span>):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    whmodel <span class="op">=</span> whisper.load_model(model_name)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(Tmax):</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(i, whmodel.transcribe(snd[<span class="dv">0</span>,:<span class="bu">int</span>(i<span class="op">*</span><span class="dv">16000</span>)])[<span class="st">'text'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="how-whisper-works-with-speech-cut-at-different-lengths" class="level2">
<h2 class="anchored" data-anchor-id="how-whisper-works-with-speech-cut-at-different-lengths">How Whisper works with speech cut at different lengths</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>test_incremental(<span class="st">'tiny.en'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0 
1  Chapter
2  Chapter 5 of the
3  Chapter 5 of the things in our garden.
4  Chapter 5 of the Things in Our Garden by Arthur Rachael.
5  Chapter 5 of the things in our garden by Arthur Ransom.
6  Chapter 5 of the Things in Our Garden by Arthur Ransom. This LibraVox Recordings.
7  Chapter 5 of the Things in Our Garden by Arthur Ransom. This LibraVox recording is in the public.
8  Chapter 5 of the Things in Our Garden by Arthur Ransom. This LibraVox recording is in the public domain.
9  Chapter 5 of the Things in Our Garden by Arthur Ransom. This LibraVox recording is in the public domain. Chapter 5
10  Chapter 5 of the Things in Our Garden by Arthur Ransom. This LibraVox recording is in the public domain. Chapter 5, their own garden.
11  Chapter 5 of the Things in Our Garden by Arthur Ransom. This LibraVox recording is in the public domain. Chapter 5, Their Own Gardens.
12  Chapter 5 of the Things in Our Garden by Arthur Ransom. This Libra-Vox recording is in the public domain. Chapter 5, Their Own Gardens.
13  Chapter 5 of the Things in Our Garden by Arthur Ransom. This Libra-Vox recording is in the public domain. Chapter 5, their own gardens, close by the wood at the
14  Chapter 5 of the Things in Our Garden by Arthur Ransom. This Libra box recording is in the public domain. Chapter 5, Their Own Gardens, Close by the wood at the bottom of the garden.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>test_incremental(<span class="st">'base.en'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0 
1  Chapter 4
2  Chapter 5 of the
3  Chapter 5 of the Things in our Guard.
4  Chapter 5 of The Things in Our Garden by Arthur Raffy
5  Chapter 5 of The Things in Our Garden by Arthur Ransom.
6  Chapter 5 of The Things in Our Garden by Arthur Ransom.
7  CHAPTER V.
8  CHAPTER V.
9  CHAPTER V.
10  CHAPTER V.
11  CHAPTER V.
12  CHAPTER V. Their Own Gardens.
13  CHAPTER V. Their Own Gardens.
14  CHAPTER V.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>test_incremental(<span class="st">'large-v2'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0 
1  Chapter 4.
2  Chapter 5 of the
3  Chapter 5 of The Things in Our Garden
4  V. THE THINGS IN OUR GARDEN
5  V. THE THINGS IN OUR GARDEN.
6  CHAPTER V
7  V. THE THINGS IN OUR GARDEN
8  CHAPTER V
9  CHAPTER V
10  V. THEIR OWN GARDEN
11  V. THEIR OWN GARDENS
12  V. THEIR OWN GARDENS
13  V. THEIR OWN GARDENS CLOSE BY THE WOOD
14  V. THEIR OWN GARDENS CLOSE BY THE WOOD AT THE BOTTOM OF THE GARDEN</code></pre>
</div>
</div>
</section>
<section id="tests-on-librispeech" class="level1">
<h1>Tests on LibriSpeech</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_test_ds(): <span class="cf">return</span> progress_bar(librispeech_data(<span class="st">'/data/LibriSpeech/test-clean'</span>), total<span class="op">=</span><span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="entropy-of-the-token-stream" class="level2">
<h2 class="anchored" data-anchor-id="entropy-of-the-token-stream">Entropy of the token stream</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> whisperspeech.vq_stoks <span class="im">import</span> RQBottleneckTransformer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> collections</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calc_model_entropy(ds, modelfile):</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    vqmodel <span class="op">=</span> RQBottleneckTransformer.load_model(local_filename<span class="op">=</span>modelfile).cuda()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    cnts <span class="op">=</span> collections.Counter()</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> snd,txt <span class="kw">in</span> ds:</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        stoks <span class="op">=</span> vqmodel.encode_audio(snd.cuda())</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        cnts.update(stoks[<span class="dv">0</span>].tolist())</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    pdf <span class="op">=</span> torch.tensor([cnts[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">max</span>(cnts)<span class="op">+</span><span class="dv">1</span>)])</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    pdf <span class="op">=</span> pdf <span class="op">/</span> pdf.<span class="bu">sum</span>()</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span>torch.nansum(pdf <span class="op">*</span> np.log2(pdf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the original semantic token model from early 2023</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:04&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">
<pre><code>6.097853445304322</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="st">"vq-ce9.2.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:04&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">
<pre><code>6.357563112144668</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="st">"vq-256c.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:04&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">
<pre><code>3.0997004132066834</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="st">"vq-256c-cosine.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:04&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">
<pre><code>5.6921860685011225</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="st">"vq-2d-256c.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:04&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">
<pre><code>2.899952018598168</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="st">"vq-2d-256c-cosine.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:04&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">
<pre><code>5.769594466589709</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="st">"vq-2d-256c-cosine-padfix2.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:04&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">
<pre><code>7.741530540488036</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="st">"vq-2d-512c-cosine-padfix-premlp-learnpos-5e.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:04&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">
<pre><code>8.164144580014993</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="st">"vq-2d-512c-cosine32-padfix-premlp-learnpos-5e.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:04&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">
<pre><code>11.37221612373814</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="st">"vq-base.en-2d-4096c-cosine32-padfix-premlp-learnpos-5e.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:08&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">
<pre><code>11.240560444030649</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="st">"vq-base.en-2d-1024c-cosine32-padfix-premlp-learnpos-5e-cleaned.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:17&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_276/107266959.py:11: RuntimeWarning: divide by zero encountered in log2
  return -torch.nansum(pdf * np.log2(pdf))</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>tensor(9.6971)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="st">"vq-base.en-2d-4096c-cosine32-padfix-premlp-learnpos-5e-cleaned.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:06&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_276/107266959.py:11: RuntimeWarning: divide by zero encountered in log2
  return -torch.nansum(pdf * np.log2(pdf))</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>tensor(11.4108)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="st">"vq-base.en-2d-4096c-cosine32-padfix-premlp-preconv-learnpos-5e-cleaned.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:17&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_103351/107266959.py:11: RuntimeWarning: divide by zero encountered in log2
  return -torch.nansum(pdf * np.log2(pdf))</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>tensor(9.9410)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="st">"vq-base.en-2d-4096c-cosine32-padfix-premlp-premean-learnpos-5e-cleaned.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:17&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_9385/107266959.py:11: RuntimeWarning: divide by zero encountered in log2
  return -torch.nansum(pdf * np.log2(pdf))</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>tensor(11.2880)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="st">"vq-base.en-2d-4096c-60k.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:20&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">
<pre><code>tensor(11.4831)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="st">"vq-base.en-2d-4096c-60k.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:20&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">
<pre><code>tensor(11.4831)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4096 tokens, we later found out that tokens from this model do carry speaker information</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="st">"vqmodel-4e-hyptuned-32gpu.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:05&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">
<pre><code>tensor(11.6404)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="st">"vqmodel-256c-4e-hyptuned-32gpu.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:05&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">
<pre><code>tensor(8.7963)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the final model</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>calc_model_entropy(make_test_ds(), <span class="st">"vqmodel-256c-dim64-4e-hyptuned-32gpu.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 00:14&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">
<pre><code>tensor(8.7499)</code></pre>
</div>
</div>
</section>
<section id="word-error-rate-measurements" class="level2">
<h2 class="anchored" data-anchor-id="word-error-rate-measurements">Word Error Rate measurements</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> whisperspeech.wer_metrics <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="vanilla-whisper-models" class="level3">
<h3 class="anchored" data-anchor-id="vanilla-whisper-models">Vanilla Whisper models</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test_wh_model(whmodel):</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    decoding_options<span class="op">=</span>whisper.DecodingOptions(language<span class="op">=</span><span class="st">'en'</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    stats <span class="op">=</span> WERStats()</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> snd, gt_text <span class="kw">in</span> progress_bar(librispeech_data(<span class="st">'/data/LibriSpeech/test-clean'</span>), total<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>        text <span class="op">=</span> whmodel.decode(whisper.log_mel_spectrogram(whisper.pad_or_trim(snd[<span class="dv">0</span>])).cuda(), decoding_options).text</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>        diff <span class="op">=</span> stats.push_sample(snd, gt_text, text)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>        last_diff <span class="op">=</span> diff.alignments[<span class="dv">0</span>][<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>        stats.push(hallucination <span class="op">=</span> last_diff.<span class="bu">type</span> <span class="op">==</span> <span class="st">'insert'</span> <span class="kw">and</span> last_diff.hyp_end_idx <span class="op">-</span> last_diff.hyp_start_idx <span class="op">&gt;</span> <span class="dv">3</span>)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    stats <span class="op">=</span> stats.df().sort_values(<span class="st">'wer'</span>)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"WER: </span><span class="sc">{</span>stats<span class="sc">.</span>wer<span class="sc">.</span>mean()<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"WER (w/o hallucinations): </span><span class="sc">{</span>stats[<span class="op">~</span>stats[<span class="st">'hallucination'</span>]]<span class="sc">.</span>wer<span class="sc">.</span>mean()<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>test_wh_model(whisper.load_model(<span class="st">'tiny.en'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:05&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 6.91%
WER (w/o hallucinations): 6.91%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
<th data-quarto-table-cell-role="th">hallucination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.230</td>
<td>None</td>
<td>AND OFTEN HAS MY MOTHER SAID WHILE ON HER LAP ...</td>
<td>And often has my mother said, while on her lap...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">355</td>
<td>2.885</td>
<td>None</td>
<td>I'M AFRAID I DON'T KNOW MUCH ABOUT THE LAND OF OZ</td>
<td>I'm afraid I don't know much about the land of...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">353</td>
<td>5.870</td>
<td>None</td>
<td>THE FIRST LOT WE TESTED ON OUR GLASS CAT WHICH...</td>
<td>The first lot we tested on our glass cat, whic...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">674</td>
<td>2.295</td>
<td>None</td>
<td>HE ONLY SHOOK HIS HEAD</td>
<td>He only shook his head.</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">675</td>
<td>11.545</td>
<td>None</td>
<td>WELL BUT NOW SAID THE PRINCESS AND SHE FILLED ...</td>
<td>Well, but now said the princess, and she fille...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">524</td>
<td>3.195</td>
<td>None</td>
<td>BROTHER MAC ARDLE BROTHER KEOGH</td>
<td>Brother Maccardo, Brother Keoff.</td>
<td>0.600000</td>
<td>0.600000</td>
<td>0.800000</td>
<td>0.200000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">592</td>
<td>1.805</td>
<td>None</td>
<td>HANS STIRS NOT</td>
<td>Hans Stairz-Nied.</td>
<td>0.666667</td>
<td>0.666667</td>
<td>0.888889</td>
<td>0.111111</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">820</td>
<td>2.155</td>
<td>None</td>
<td>THE FORMER BOOLOOROO GROANED</td>
<td>The former Billie Rook-Round</td>
<td>0.750000</td>
<td>0.600000</td>
<td>0.800000</td>
<td>0.200000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">918</td>
<td>3.000</td>
<td>None</td>
<td>THAT IS TRUE BADAUDERIE</td>
<td>That is true bad dealt gree.</td>
<td>0.750000</td>
<td>0.500000</td>
<td>0.625000</td>
<td>0.375000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>None</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cause A was my man's servant.</td>
<td>1.250000</td>
<td>0.714286</td>
<td>0.857143</td>
<td>0.142857</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>1000 rows × 9 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>test_wh_model(whisper.load_model(<span class="st">'base.en'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:41&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 5.08%
WER (w/o hallucinations): 5.08%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">hallucination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.230</td>
<td>AND OFTEN HAS MY MOTHER SAID WHILE ON HER LAP ...</td>
<td>And often has my mother said while on her lap ...</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">403</td>
<td>5.370</td>
<td>DEPARTING FROM FIVE HUNDRED THOUSAND THROATS T...</td>
<td>Departing from 500,000 throats, three cheers b...</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">404</td>
<td>13.140</td>
<td>THOUSANDS OF HANDKERCHIEFS WERE WAVING ABOVE T...</td>
<td>Thousands of handkerchiefs were waving above t...</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">405</td>
<td>2.695</td>
<td>IT'S ALMOST BEYOND CONJECTURE</td>
<td>It's almost beyond conjecture.</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">406</td>
<td>7.805</td>
<td>THIS REALITY BEGINS TO EXPLAIN THE DARK POWER ...</td>
<td>This reality begins to explain the dark power ...</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">524</td>
<td>3.195</td>
<td>BROTHER MAC ARDLE BROTHER KEOGH</td>
<td>Brother McCartill, Brother Kiaff.</td>
<td>0.600000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">592</td>
<td>1.805</td>
<td>HANS STIRS NOT</td>
<td>Hans Sturznide.</td>
<td>0.666667</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">918</td>
<td>3.000</td>
<td>THAT IS TRUE BADAUDERIE</td>
<td>That is true, bad girl degree.</td>
<td>0.750000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cas￩ was my man's servant.</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefano Staedt-Loss</td>
<td>1.500000</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>1000 rows ￗ 5 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>test_wh_model(whisper.load_model(<span class="st">'small.en'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 02:53&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 3.89%
WER (w/o hallucinations): 3.84%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
<th data-quarto-table-cell-role="th">hallucination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.230</td>
<td>None</td>
<td>AND OFTEN HAS MY MOTHER SAID WHILE ON HER LAP ...</td>
<td>And often has my mother said, while on her lap...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">789</td>
<td>5.945</td>
<td>None</td>
<td>AND THIS PLAN WAS ADOPTED TOO IN ORDER TO EXTR...</td>
<td>and this plan was adopted too in order to extr...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">461</td>
<td>10.980</td>
<td>None</td>
<td>SHE MEANWHILE PASSED HER LIFE WITH HER PARENTS...</td>
<td>She, meanwhile, passed her life with her paren...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">464</td>
<td>8.845</td>
<td>None</td>
<td>ONE DAY WHEN THE BOY WAS SENT BY HIS GRANDFATH...</td>
<td>One day when the boy was sent by his grandfath...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">465</td>
<td>8.785</td>
<td>None</td>
<td>THE BED SHE TOO WELL REMEMBERED WAS THERE AND ...</td>
<td>The bed she too well remembered was there, and...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">524</td>
<td>3.195</td>
<td>None</td>
<td>BROTHER MAC ARDLE BROTHER KEOGH</td>
<td>Brother McCardle. Brother Kiyof.</td>
<td>0.600000</td>
<td>0.600000</td>
<td>0.800000</td>
<td>0.200000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">288</td>
<td>1.905</td>
<td>None</td>
<td>I DELIGHT IN YOUR KITCHEN</td>
<td>by delighting your kitchen.</td>
<td>0.600000</td>
<td>0.600000</td>
<td>0.800000</td>
<td>0.200000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">121</td>
<td>15.270</td>
<td>None</td>
<td>AT LAST THE LITTLE MICE STAYED AWAY ALSO AND T...</td>
<td>At last the little mice stayed away also, and ...</td>
<td>0.636364</td>
<td>0.636364</td>
<td>0.636364</td>
<td>0.363636</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">918</td>
<td>3.000</td>
<td>None</td>
<td>THAT IS TRUE BADAUDERIE</td>
<td>That is true Bad Delt Grey.</td>
<td>0.750000</td>
<td>0.500000</td>
<td>0.625000</td>
<td>0.375000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefano Staedtlos</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>1000 rows × 9 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>test_wh_model(whisper.load_model(<span class="st">'medium.en'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 06:22&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 4.19%
WER (w/o hallucinations): 3.19%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">hallucination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">386</td>
<td>5.915</td>
<td>YES WE ARE CERTAINLY I REPLIED EVASIVELY BUT A...</td>
<td>Yes, we are, certainly, I replied evasively, b...</td>
<td>0.00</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">507</td>
<td>6.480</td>
<td>HIS CONDUCT AND PRESENCE OF MIND IN THIS EMERG...</td>
<td>His conduct and presence of mind in this emerg...</td>
<td>0.00</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">865</td>
<td>4.315</td>
<td>THEIR SUFFERINGS HAVE NEVER YET BEEN FITLY CHR...</td>
<td>Their sufferings have never yet been fitly chr...</td>
<td>0.00</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">509</td>
<td>13.610</td>
<td>FROM THE SAME MEN NEW REGIMENTS AND NEW COMPAN...</td>
<td>From the same men new regiments and new compan...</td>
<td>0.00</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">511</td>
<td>12.655</td>
<td>THOUGH THE DISCIPLINE OF THE FORMER PARLIAMENT...</td>
<td>Though the discipline of the former parliament...</td>
<td>0.00</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">782</td>
<td>2.260</td>
<td>TO DAY I SHOUTED</td>
<td>Today, I shouted.</td>
<td>0.50</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">524</td>
<td>3.195</td>
<td>BROTHER MAC ARDLE BROTHER KEOGH</td>
<td>Brother McCardle, Brother Kiyof.</td>
<td>0.60</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">918</td>
<td>3.000</td>
<td>THAT IS TRUE BADAUDERIE</td>
<td>That is true bad health grief.</td>
<td>0.75</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefanos Daedalus</td>
<td>1.00</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">226</td>
<td>6.750</td>
<td>HE CONTINUED HIS PRETENDED SEARCH AND TO GIVE ...</td>
<td>He continued his pretended search, and to give...</td>
<td>9.80</td>
<td>True</td>
</tr>
</tbody>
</table>

<p>1000 rows × 5 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>test_wh_model(whisper.load_model(<span class="st">'large-v2'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 07:39&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 6.07%
WER (w/o hallucinations): 3.19%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
<th data-quarto-table-cell-role="th">hallucination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.230</td>
<td>None</td>
<td>AND OFTEN HAS MY MOTHER SAID WHILE ON HER LAP ...</td>
<td>And often has my mother said while on her lap ...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">606</td>
<td>2.610</td>
<td>None</td>
<td>WE SUFFER STIFLING PAINS</td>
<td>We suffer stifling pains.</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">607</td>
<td>7.040</td>
<td>None</td>
<td>SATURDAY AUGUST FIFTEENTH THE SEA UNBROKEN ALL...</td>
<td>Saturday, August 15th. The sea unbroken all ro...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">608</td>
<td>3.070</td>
<td>None</td>
<td>THE HORIZON SEEMS EXTREMELY DISTANT</td>
<td>The horizon seems extremely distant.</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">609</td>
<td>9.985</td>
<td>None</td>
<td>ALL MY DANGER AND SUFFERINGS WERE NEEDED TO ST...</td>
<td>All my danger and sufferings were needed to st...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">592</td>
<td>1.805</td>
<td>None</td>
<td>HANS STIRS NOT</td>
<td>Hans Sturznott</td>
<td>0.666667</td>
<td>0.666667</td>
<td>0.833333</td>
<td>0.166667</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">95</td>
<td>8.800</td>
<td>None</td>
<td>THOUGHT THE FIR TREE AND BELIEVED IT ALL BECAU...</td>
<td>thought the fir tree, and believed it all, bec...</td>
<td>4.285714</td>
<td>0.810811</td>
<td>0.810811</td>
<td>0.189189</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">902</td>
<td>7.370</td>
<td>None</td>
<td>I HAD A NAME I BELIEVE IN MY YOUNG DAYS BUT I ...</td>
<td>I had a name, I believe, in my young days, but...</td>
<td>7.476190</td>
<td>0.882022</td>
<td>0.882022</td>
<td>0.117978</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">610</td>
<td>7.370</td>
<td>None</td>
<td>YOU SEEM ANXIOUS MY UNCLE I SAID SEEING HIM CO...</td>
<td>"'You seem anxious, my uncle,' I said, seeing ...</td>
<td>7.823529</td>
<td>0.886667</td>
<td>0.886667</td>
<td>0.113333</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">438</td>
<td>6.665</td>
<td>None</td>
<td>AS TO HIS AGE AND ALSO THE NAME OF HIS MASTER ...</td>
<td>As to his age, and also the name of his master...</td>
<td>8.631579</td>
<td>0.896175</td>
<td>0.896175</td>
<td>0.103825</td>
<td>True</td>
</tr>
</tbody>
</table>

<p>1000 rows × 9 columns</p>
</div>
</div>
</div>
</section>
<section id="quantized-whisper-models" class="level3">
<h3 class="anchored" data-anchor-id="quantized-whisper-models">Quantized Whisper models</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test_model(modelfile, N<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    vqmodel <span class="op">=</span> RQBottleneckTransformer.load_model(local_filename<span class="op">=</span>modelfile).cuda()</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    stats <span class="op">=</span> WERStats()</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> snd, gt_text <span class="kw">in</span> progress_bar(librispeech_data(<span class="st">'/data/LibriSpeech/test-clean'</span>), total<span class="op">=</span>N):</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>        stoks <span class="op">=</span> vqmodel.encode_audio(snd.cuda())</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>        text <span class="op">=</span> vqmodel.decode_text(stoks[<span class="dv">0</span>])[<span class="dv">0</span>].text</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>        diff <span class="op">=</span> stats.push_sample(snd, gt_text, text)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>        last_diff <span class="op">=</span> diff.alignments[<span class="dv">0</span>][<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>        stats.push(hallucination <span class="op">=</span> last_diff.<span class="bu">type</span> <span class="op">==</span> <span class="st">'insert'</span> <span class="kw">and</span> last_diff.hyp_end_idx <span class="op">-</span> last_diff.hyp_start_idx <span class="op">&gt;</span> <span class="dv">3</span>)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>    stats <span class="op">=</span> stats.df().sort_values(<span class="st">'wer'</span>)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"WER: </span><span class="sc">{</span>stats<span class="sc">.</span>wer<span class="sc">.</span>mean()<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"WER (w/o hallucinations): </span><span class="sc">{</span>stats[<span class="op">~</span>stats[<span class="st">'hallucination'</span>]]<span class="sc">.</span>wer<span class="sc">.</span>mean()<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="va">None</span>) <span class="co"># the old stoks model from early 2023</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:10&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 16.06%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">gt_texts</th>
<th data-quarto-table-cell-role="th">texts</th>
<th data-quarto-table-cell-role="th">wers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">207</td>
<td>4.075</td>
<td>SEVERAL HUNDRED FREE STATE MEN PROMPTLY RESPON...</td>
<td>several hundred free state men promptly respon...</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">209</td>
<td>5.295</td>
<td>THE LEADERS OF THE CONSPIRACY BECAME DISTRUSTF...</td>
<td>The leaders of the conspiracy became distrustf...</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">709</td>
<td>2.440</td>
<td>THE THREE MODES OF MANAGEMENT</td>
<td>The three modes of management.</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">708</td>
<td>13.020</td>
<td>THE PAIN PRODUCED BY AN ACT OF HASTY AND ANGRY...</td>
<td>The pain produced by an act of hasty and angry...</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">705</td>
<td>5.250</td>
<td>THEY ARE CHIEFLY FORMED FROM COMBINATIONS OF T...</td>
<td>They are chiefly formed from combinations of t...</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>COSA was my man's servant.</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">144</td>
<td>4.680</td>
<td>AND BESIDES SUPPOSE THEE DOES LEARN MEDICINE</td>
<td>and be sides, supposed to be lost, Lord medicine.</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">907</td>
<td>4.195</td>
<td>MADAME QUINSON BESIDES CAN ANSWER YOUR ENQUIRIES</td>
<td>Madam Gwen-Saun, besides Ken Sir Ian Corrie's.</td>
<td>1.142857</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">187</td>
<td>2.230</td>
<td>NO ITS NOT TOO SOON</td>
<td>Know what's sought to assume.</td>
<td>1.200000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>STEPHANOS DEDALOS</td>
<td>Stephano's Nerdos.</td>
<td>1.500000</td>
</tr>
</tbody>
</table>

<p>1000 rows × 4 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">'vq-ce9.2.model'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:12&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 8.80%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">gt_texts</th>
<th data-quarto-table-cell-role="th">texts</th>
<th data-quarto-table-cell-role="th">wers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.230</td>
<td>AND OFTEN HAS MY MOTHER SAID WHILE ON HER LAP ...</td>
<td>And often has my mother said, while on her lap...</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">283</td>
<td>1.420</td>
<td>DIRECTION</td>
<td>direction.</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">282</td>
<td>2.385</td>
<td>I DIDN'T PREACH WITHOUT DIRECTION</td>
<td>I didn't preach without direction.</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">624</td>
<td>3.975</td>
<td>I SHUDDER AS I RECALL THESE MONSTERS TO MY REM...</td>
<td>I shudder as I recall these monsters to my rem...</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">279</td>
<td>10.490</td>
<td>WE CAN ALL BE SERVANTS OF GOD WHEREVER OUR LOT...</td>
<td>We can all be servants of God, wherever our lo...</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">820</td>
<td>2.155</td>
<td>THE FORMER BOOLOOROO GROANED</td>
<td>the former Boula Rook round.</td>
<td>0.750000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">918</td>
<td>3.000</td>
<td>THAT IS TRUE BADAUDERIE</td>
<td>That is true, bad, old-gree.</td>
<td>0.750000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">105</td>
<td>6.555</td>
<td>IF IT ONLY WERE NOT SO DARK HERE AND SO TERRIB...</td>
<td>If... ... ... ... ... ... ... ... ... ... ... ...</td>
<td>0.916667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Jose was my man's servant.</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefanos de los</td>
<td>1.500000</td>
</tr>
</tbody>
</table>

<p>1000 rows × 4 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">'vq-256c.model'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:13&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 10.26%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">gt_texts</th>
<th data-quarto-table-cell-role="th">texts</th>
<th data-quarto-table-cell-role="th">wers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">789</td>
<td>5.945</td>
<td>AND THIS PLAN WAS ADOPTED TOO IN ORDER TO EXTR...</td>
<td>And this plan was adopted too, in order to ext...</td>
<td>0.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">365</td>
<td>5.780</td>
<td>I WILL SHOW YOU WHAT A GOOD JOB I DID AND SHE ...</td>
<td>I will show you what a good job I did. And she...</td>
<td>0.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">722</td>
<td>10.720</td>
<td>AS I SPOKE I MADE HIM A GRACIOUS BOW AND I THI...</td>
<td>As I spoke, I made him a gracious bow, and I t...</td>
<td>0.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">723</td>
<td>7.840</td>
<td>I HAVE COME TO YOUR SHORES MISTER PRESIDENT WI...</td>
<td>I have come to your shores, Mr. President, wit...</td>
<td>0.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">362</td>
<td>5.335</td>
<td>SOMETIMES IT IS CALLED A CRAZY QUILT BECAUSE T...</td>
<td>Sometimes it is called a crazy quilt because t...</td>
<td>0.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">106</td>
<td>2.020</td>
<td>SQUEAK SQUEAK</td>
<td>Squick. Squick.</td>
<td>1.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>STEPHANOS DEDALOS</td>
<td>Stephanos de Arlos.</td>
<td>1.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">288</td>
<td>1.905</td>
<td>I DELIGHT IN YOUR KITCHEN</td>
<td>I'd like to introduce you in your kitchen.</td>
<td>1.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Call say, was my man servant?</td>
<td>1.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">381</td>
<td>4.880</td>
<td>CONSEIL I CALLED A THIRD TIME CONSEIL APPEARED</td>
<td>Can't say, at call the third time. Can't say a...</td>
<td>1.125</td>
</tr>
</tbody>
</table>

<p>1000 rows × 4 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">'vq-256c-cosine.model'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:10&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 10.24%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">gt_texts</th>
<th data-quarto-table-cell-role="th">texts</th>
<th data-quarto-table-cell-role="th">wers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">710</td>
<td>11.490</td>
<td>TO SUPPOSE THAT THE OBJECT OF THIS WORK IS TO ...</td>
<td>To suppose that the object of this work is to ...</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">629</td>
<td>3.235</td>
<td>TWO HOURS AFTERWARDS A TERRIBLE SHOCK AWOKE ME</td>
<td>Two hours afterwards, a terrible shock awoke me.</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">640</td>
<td>1.740</td>
<td>POOR ALICE</td>
<td>Poor Alice.</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">262</td>
<td>2.435</td>
<td>THAT'S WHAT YOU'D LIKE TO BE DOING IS IT</td>
<td>That's what you'd like to be doing, is it?</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">644</td>
<td>3.105</td>
<td>AND YESTERDAY THINGS WENT ON JUST AS USUAL</td>
<td>And yesterday, things went on just as usual.</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">187</td>
<td>2.230</td>
<td>NO ITS NOT TOO SOON</td>
<td>No, it's not just here.</td>
<td>0.800000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">115</td>
<td>4.470</td>
<td>WHO IS HUMPY DUMPY ASKED THE MICE</td>
<td>Who is a MP? Don't be. Ask the mice.</td>
<td>0.857143</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cross say, was my man servant.</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">106</td>
<td>2.020</td>
<td>SQUEAK SQUEAK</td>
<td>quick, quick.</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>STEPHANOS DEDALOS</td>
<td>Stephenos der los.</td>
<td>1.500000</td>
</tr>
</tbody>
</table>

<p>1000 rows × 4 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">'vq-2d-256c.model'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:11&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 21.75%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">gt_texts</th>
<th data-quarto-table-cell-role="th">texts</th>
<th data-quarto-table-cell-role="th">wers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">709</td>
<td>2.440</td>
<td>THE THREE MODES OF MANAGEMENT</td>
<td>The Three Modes of Management</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">419</td>
<td>2.415</td>
<td>FATHOM SIX FEET</td>
<td>Fathom six feet.</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">703</td>
<td>4.775</td>
<td>NATURE OF THE EFFECT PRODUCED BY EARLY IMPRESS...</td>
<td>nature of the effect produced by early impress...</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">693</td>
<td>2.110</td>
<td>I AM VERY GLAD</td>
<td>I am very glad.</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">686</td>
<td>2.740</td>
<td>NO MY LITTLE SON SHE SAID</td>
<td>No, my little son, she said.</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">627</td>
<td>3.060</td>
<td>TUESDAY AUGUST EIGHTEENTH</td>
<td>2. Day August 8th</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">820</td>
<td>2.155</td>
<td>THE FORMER BOOLOOROO GROANED</td>
<td>The former Bill of Rook around.</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>5.530</td>
<td>KESWICK MARCH TWENTY SECOND EIGHTEEN THIRTY SE...</td>
<td>Yes, we wish between second 1837. Did you reme...</td>
<td>1.333333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">106</td>
<td>2.020</td>
<td>SQUEAK SQUEAK</td>
<td>Quick, quick, quick.</td>
<td>1.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">792</td>
<td>1.810</td>
<td>VENICE</td>
<td>Then Next</td>
<td>2.000000</td>
</tr>
</tbody>
</table>

<p>1000 rows × 4 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">'vq-2d-256c-cosine.model'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:11&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 11.61%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">gt_texts</th>
<th data-quarto-table-cell-role="th">texts</th>
<th data-quarto-table-cell-role="th">wers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">686</td>
<td>2.740</td>
<td>NO MY LITTLE SON SHE SAID</td>
<td>No, my little son, she said.</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">902</td>
<td>7.370</td>
<td>I HAD A NAME I BELIEVE IN MY YOUNG DAYS BUT I ...</td>
<td>I had a name I believe in my young days, but I...</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">904</td>
<td>3.300</td>
<td>YOU DO ME A GREAT HONOUR</td>
<td>You do me a great honor.</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">228</td>
<td>6.775</td>
<td>AS HE HAD PROMISED TO PROTECT THE HOTEL THE RE...</td>
<td>As he had promised to protect the hotel, the r...</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">521</td>
<td>3.440</td>
<td>SOON THE WHOLE BRIDGE WAS TREMBLING AND RESOUN...</td>
<td>Soon the whole bridge was trembling and resoun...</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">918</td>
<td>3.000</td>
<td>THAT IS TRUE BADAUDERIE</td>
<td>That is true, bad, old-gree.</td>
<td>0.750000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">381</td>
<td>4.880</td>
<td>CONSEIL I CALLED A THIRD TIME CONSEIL APPEARED</td>
<td>Conse, at call to third town. Conse, appeared.</td>
<td>0.750000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">115</td>
<td>4.470</td>
<td>WHO IS HUMPY DUMPY ASKED THE MICE</td>
<td>Who eats umpi, don't pee? Ask the mice.</td>
<td>0.857143</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>STEPHANOS DEDALOS</td>
<td>Stephenau Stairlauce.</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">106</td>
<td>2.020</td>
<td>SQUEAK SQUEAK</td>
<td>Speak. Speak. Speak.</td>
<td>1.500000</td>
</tr>
</tbody>
</table>

<p>1000 rows × 4 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># full crop</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">'vq-2d-256c-cosine-padfix2.model'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:10&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 16.13%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">gt_texts</th>
<th data-quarto-table-cell-role="th">texts</th>
<th data-quarto-table-cell-role="th">wers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">652</td>
<td>3.475</td>
<td>I AM SO VERY TIRED OF BEING ALL ALONE HERE</td>
<td>I'm so very tired of being all alone here.</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">906</td>
<td>2.610</td>
<td>AT YOUR SERVICE SIR</td>
<td>At your service, sir.</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">904</td>
<td>3.300</td>
<td>YOU DO ME A GREAT HONOUR</td>
<td>You do me a great honor.</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">902</td>
<td>7.370</td>
<td>I HAD A NAME I BELIEVE IN MY YOUNG DAYS BUT I ...</td>
<td>I had a name I believe in my young days, but I...</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">901</td>
<td>2.755</td>
<td>I NEVER HAD ANY FAMILY</td>
<td>I never had any family.</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">448</td>
<td>2.215</td>
<td>WHO TOUCHES ME AM I IN BED</td>
<td>Look at us, me, our young dad.</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">934</td>
<td>4.205</td>
<td>I RESIDE IN THE MARAIS RUE DE DOUZE PORTES</td>
<td>Irae's eye in the Ma'rae's crew did to support.</td>
<td>1.111111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>STEPHANOS DEDALOS</td>
<td>Step 4, Zetelos.</td>
<td>1.500000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>1.695</td>
<td>FAREWELL MADAM</td>
<td>Fair will, damn.</td>
<td>1.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cos they were my man's servant.</td>
<td>1.500000</td>
</tr>
</tbody>
</table>

<p>1000 rows × 4 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># no cropping</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">'vq-2d-256c-cosine-padfix2.model'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:10&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 11.17%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">gt_texts</th>
<th data-quarto-table-cell-role="th">texts</th>
<th data-quarto-table-cell-role="th">wers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">839</td>
<td>2.275</td>
<td>THE CAPTAIN SHOOK HIS HEAD</td>
<td>The captain shook his head.</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">408</td>
<td>9.935</td>
<td>NEMO BUILDS A FABULOUS FUTURISTIC SUBMARINE TH...</td>
<td>Nemo builds a fabulous futuristic submarine, t...</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">405</td>
<td>2.695</td>
<td>IT'S ALMOST BEYOND CONJECTURE</td>
<td>It's almost beyond conjecture.</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">404</td>
<td>13.140</td>
<td>THOUSANDS OF HANDKERCHIEFS WERE WAVING ABOVE T...</td>
<td>Thousands of handkerchiefs were waving above t...</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">790</td>
<td>14.900</td>
<td>BRIGHTER THAN EARLY DAWN'S MOST BRILLIANT DYE ...</td>
<td>Brighter than early dawn's most brilliant dye ...</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>STEPHANOS DEDALOS</td>
<td>Stephenos dellos</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">592</td>
<td>1.805</td>
<td>HANS STIRS NOT</td>
<td>Honsters nod.</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">907</td>
<td>4.195</td>
<td>MADAME QUINSON BESIDES CAN ANSWER YOUR ENQUIRIES</td>
<td>Madam Quinsong, besides Cinanza, you're in que...</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">115</td>
<td>4.470</td>
<td>WHO IS HUMPY DUMPY ASKED THE MICE</td>
<td>Phew, he's on P, don't pee. Ask the mice.</td>
<td>1.142857</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cos they were my man's servant.</td>
<td>1.500000</td>
</tr>
</tbody>
</table>

<p>1000 rows ￗ 4 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># crop to 200 toks minimum</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">'vq-2d-256c-cosine-padfix2.model'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:10&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 12.56%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">gt_texts</th>
<th data-quarto-table-cell-role="th">texts</th>
<th data-quarto-table-cell-role="th">wers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">871</td>
<td>2.920</td>
<td>WHO BEGAN THE QUARREL WAS IT THE MORMONS</td>
<td>Who began the quarrel? Was it the Mormons?</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">938</td>
<td>12.435</td>
<td>HOW STRANGE IT SEEMED TO THE SAD WOMAN AS SHE ...</td>
<td>How strange it seemed to the sad woman, as she...</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">937</td>
<td>12.605</td>
<td>HIS HOUSEKEEPER HAD THE MANAGEMENT OF EVERYTHI...</td>
<td>His housekeeper had the management of everythi...</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">558</td>
<td>15.720</td>
<td>IT WAS STRANGE TOO THAT HE FOUND AN ARID PLEAS...</td>
<td>It was strange too, that he found an arid plea...</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">305</td>
<td>3.835</td>
<td>THE HEAD OF THE PATCHWORK GIRL WAS THE MOST CU...</td>
<td>The head of the patchwork girl was the most cu...</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>STEPHANOS DEDALOS</td>
<td>Stephenos dellos</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">907</td>
<td>4.195</td>
<td>MADAME QUINSON BESIDES CAN ANSWER YOUR ENQUIRIES</td>
<td>Madam Quinsong, besides Cenanza, you're in que...</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">106</td>
<td>2.020</td>
<td>SQUEAK SQUEAK</td>
<td>Quick, quick.</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">115</td>
<td>4.470</td>
<td>WHO IS HUMPY DUMPY ASKED THE MICE</td>
<td>P-E-S-A-P, don't be... asked the mice.</td>
<td>1.142857</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cos-A was my man's servant.</td>
<td>1.250000</td>
</tr>
</tbody>
</table>

<p>1000 rows ￗ 4 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># crop to audio length</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">'vq-2d-512c-cosine-padfix-premlp-learnpos.model'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:09&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 9.89%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">gt_texts</th>
<th data-quarto-table-cell-role="th">texts</th>
<th data-quarto-table-cell-role="th">wers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">570</td>
<td>2.715</td>
<td>BEWARE OF MAKING THAT MISTAKE</td>
<td>Beware of making that mistake.</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">260</td>
<td>3.155</td>
<td>WHO TAUGHT YOU TO SCRUB A FLOOR I SHOULD LIKE ...</td>
<td>Who taught you to scrub a floor? I should like...</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">800</td>
<td>5.770</td>
<td>OLD DANCES ARE SIMPLIFIED OF THEIR YEARNING BL...</td>
<td>Old dances are simplified of their yearning, b...</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">258</td>
<td>2.260</td>
<td>SPINNING INDEED</td>
<td>Spinning Indeed.</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">653</td>
<td>3.815</td>
<td>AND I DECLARE IT'S TOO BAD THAT IT IS</td>
<td>And I declare it's too bad that it is.</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">934</td>
<td>4.205</td>
<td>I RESIDE IN THE MARAIS RUE DE DOUZE PORTES</td>
<td>Iries I'd in the Marfra Grudetus port.</td>
<td>0.777778</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">115</td>
<td>4.470</td>
<td>WHO IS HUMPY DUMPY ASKED THE MICE</td>
<td>Who is a P-Don't Be? Ask the mice.</td>
<td>0.857143</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">448</td>
<td>2.215</td>
<td>WHO TOUCHES ME AM I IN BED</td>
<td>Potatys me, and my embed.</td>
<td>0.857143</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">592</td>
<td>1.805</td>
<td>HANS STIRS NOT</td>
<td>Han Stersnide</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefanos de los</td>
<td>1.500000</td>
</tr>
</tbody>
</table>

<p>1000 rows ￗ 4 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># crop to audio length</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">'vq-2d-512c-cosine-padfix-premlp-learnpos-5e.model'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:09&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 9.51%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">gt_texts</th>
<th data-quarto-table-cell-role="th">texts</th>
<th data-quarto-table-cell-role="th">wers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.230</td>
<td>AND OFTEN HAS MY MOTHER SAID WHILE ON HER LAP ...</td>
<td>And often has my mother said, while on her lap...</td>
<td>0.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">607</td>
<td>7.040</td>
<td>SATURDAY AUGUST FIFTEENTH THE SEA UNBROKEN ALL...</td>
<td>Saturday, August 15th. The sea unbroken all ro...</td>
<td>0.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">608</td>
<td>3.070</td>
<td>THE HORIZON SEEMS EXTREMELY DISTANT</td>
<td>The horizon seems extremely distant.</td>
<td>0.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">615</td>
<td>3.735</td>
<td>THEREFORE DON'T TALK TO ME ABOUT VIEWS AND PRO...</td>
<td>Therefore, don't talk to me about views and pr...</td>
<td>0.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">616</td>
<td>5.795</td>
<td>I TAKE THIS AS MY ANSWER AND I LEAVE THE PROFE...</td>
<td>I take this as my answer and I leave the profe...</td>
<td>0.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">157</td>
<td>3.830</td>
<td>AND THEE WON'T GO WHY SHOULD I</td>
<td>And, see you all next time!</td>
<td>0.875</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">381</td>
<td>4.880</td>
<td>CONSEIL I CALLED A THIRD TIME CONSEIL APPEARED</td>
<td>Can say, at call the third time, can say appea...</td>
<td>0.875</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Caus￩ was my man's servant.</td>
<td>1.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefanos dellos.</td>
<td>1.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">106</td>
<td>2.020</td>
<td>SQUEAK SQUEAK</td>
<td>Sweet, sweet.</td>
<td>1.000</td>
</tr>
</tbody>
</table>

<p>1000 rows ￗ 4 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># crop to audio length</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">'vq-2d-512c-cosine32-padfix-premlp-learnpos-5e.model'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:08&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 9.84%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">310</td>
<td>4.040</td>
<td>SHE POURED INTO THE DISH A QUANTITY FROM EACH ...</td>
<td>She poured into the dish a quantity from each ...</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">387</td>
<td>2.735</td>
<td>A ROUTE SLIGHTLY LESS DIRECT THAT'S ALL</td>
<td>a route slightly less direct, that's all.</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">385</td>
<td>4.530</td>
<td>ANYHOW WE'LL LEAVE INSTRUCTIONS TO SHIP THE WH...</td>
<td>Anyhow, we'll leave instructions to ship the w...</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">742</td>
<td>4.730</td>
<td>WE SAT WITH THE OFFICERS SOME LITTLE TIME AFTE...</td>
<td>We sat with the officers some little time afte...</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">383</td>
<td>9.300</td>
<td>PACK AS MUCH INTO MY TRUNK AS YOU CAN MY TRAVE...</td>
<td>Pack as much into my trunk as you can. My trav...</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">559</td>
<td>13.895</td>
<td>THE SENTENCE OF SAINT JAMES WHICH SAYS THAT HE...</td>
<td>Thank you.</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">775</td>
<td>5.545</td>
<td>THE PECULIAR CIRCUMSTANCES OF THE COLONY ARE W...</td>
<td>Thank you.</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">106</td>
<td>2.020</td>
<td>SQUEAK SQUEAK</td>
<td>Quick, quick.</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>STEPHANOS DEDALOS</td>
<td>Stephanos de los</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">491</td>
<td>4.805</td>
<td>THE PARLIAMENT AND THE SCOTS LAID THEIR PROPOS...</td>
<td>Thank you.</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>1000 rows × 4 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"vq-base.en-2d-4096c-cosine32-padfix-premlp-learnpos-5e.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:41&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 7.51%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">862</td>
<td>6.720</td>
<td>TO THE FERVENT LATTER DAY SAINT A TEMPLE IS NO...</td>
<td>To the fervent Latter-day Saint, a temple is n...</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">436</td>
<td>6.380</td>
<td>SHE WAS A LARGE HOMELY WOMAN THEY WERE COMMON ...</td>
<td>She was a large, homely woman. They were commo...</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">437</td>
<td>5.425</td>
<td>SUBSTANTIALLY THIS WAS JACOB'S UNVARNISHED DES...</td>
<td>Substantially, this was Jacob's unvarnished de...</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">438</td>
<td>6.665</td>
<td>AS TO HIS AGE AND ALSO THE NAME OF HIS MASTER ...</td>
<td>As to his age and also the name of his master,...</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">439</td>
<td>3.020</td>
<td>OF STARTING I DIDN'T KNOW THE WAY TO COME</td>
<td>of starting. I didn't know the way to come.</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">480</td>
<td>12.510</td>
<td>THIS WAS DONE FOR THE EVENT TOOK PLACE AT A TI...</td>
<td>This was done for the event took place.</td>
<td>0.783784</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">713</td>
<td>17.945</td>
<td>THE MOTHER AS SOON AS THE CHAISE IS SO FAR TUR...</td>
<td>The Mother. As soon as the chase</td>
<td>0.869565</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">454</td>
<td>7.720</td>
<td>AMONG OTHER THINGS ON WHICH SHE CAST HER EYES ...</td>
<td>Among other things...</td>
<td>0.869565</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cossay was my man's servant.</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefano Staedt-Los</td>
<td>1.500000</td>
</tr>
</tbody>
</table>

<p>1000 rows × 4 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"vq-base.en-2d-4096c-cosine32-padfix-premlp-learnpos-5e.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:33&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 7.49%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">714</td>
<td>8.010</td>
<td>None</td>
<td>SO YOU WILL BE A GOOD GIRL I KNOW AND NOT MAKE...</td>
<td>So you will be a good girl, I know, and not ma...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">365</td>
<td>5.780</td>
<td>None</td>
<td>I WILL SHOW YOU WHAT A GOOD JOB I DID AND SHE ...</td>
<td>I will show you what a good job I did, and she...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">608</td>
<td>3.070</td>
<td>None</td>
<td>THE HORIZON SEEMS EXTREMELY DISTANT</td>
<td>The horizon seems extremely distant.</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">362</td>
<td>5.335</td>
<td>None</td>
<td>SOMETIMES IT IS CALLED A CRAZY QUILT BECAUSE T...</td>
<td>Sometimes it is called a crazy quilt because t...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">361</td>
<td>6.045</td>
<td>None</td>
<td>A BED QUILT MADE OF PATCHES OF DIFFERENT KINDS...</td>
<td>A bed quilt made of patches of different kinds...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">480</td>
<td>12.510</td>
<td>None</td>
<td>THIS WAS DONE FOR THE EVENT TOOK PLACE AT A TI...</td>
<td>This was done for the event took place.</td>
<td>0.783784</td>
<td>0.783784</td>
<td>0.783784</td>
<td>0.216216</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">454</td>
<td>7.720</td>
<td>None</td>
<td>AMONG OTHER THINGS ON WHICH SHE CAST HER EYES ...</td>
<td>Among other things...</td>
<td>0.869565</td>
<td>0.869565</td>
<td>0.869565</td>
<td>0.130435</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">713</td>
<td>17.945</td>
<td>None</td>
<td>THE MOTHER AS SOON AS THE CHAISE IS SO FAR TUR...</td>
<td>The Mother. As soon as the chase</td>
<td>0.869565</td>
<td>0.869565</td>
<td>0.888199</td>
<td>0.111801</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>None</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cossay was my man's servant.</td>
<td>1.000000</td>
<td>0.666667</td>
<td>0.833333</td>
<td>0.166667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefano Staedt-Los</td>
<td>1.500000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
</tr>
</tbody>
</table>

<p>1000 rows × 8 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"vq-base.en-2d-1024c-cosine32-padfix-premlp-learnpos-5e-cleaned.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:31&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 10.44%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">669</td>
<td>8.540</td>
<td>None</td>
<td>AT THE FARTHER END OF THE LARGEST HALL A TABLE...</td>
<td>At the farther end of the largest hall, a tabl...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">349</td>
<td>2.130</td>
<td>None</td>
<td>THE WOMAN SEEMED THOUGHTFUL</td>
<td>The woman seemed thoughtful.</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">572</td>
<td>4.090</td>
<td>None</td>
<td>HE IS CALLED AS YOU KNOW THE APOSTLE OF THE IN...</td>
<td>He is called, as you know, the apostle of the ...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">347</td>
<td>3.665</td>
<td>None</td>
<td>OJO HAD NEVER EATEN SUCH A FINE MEAL IN ALL HI...</td>
<td>Ojo had never eaten such a fine meal in all hi...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">346</td>
<td>3.705</td>
<td>None</td>
<td>AND YOU MUST BE OJO THE UNLUCKY SHE ADDED</td>
<td>And you must be Ojo the unlucky," she added.</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">896</td>
<td>18.540</td>
<td>None</td>
<td>SILVIA WAS THE ADORATION OF FRANCE AND HER TAL...</td>
<td>Sylvia</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">689</td>
<td>5.995</td>
<td>None</td>
<td>DELLA HAD A YOUNG SISTER NAMED MARIA AND A COU...</td>
<td>Dela.</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">512</td>
<td>27.525</td>
<td>None</td>
<td>VALOR INDEED WAS VERY GENERALLY DIFFUSED OVER ...</td>
<td>Vala.</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">897</td>
<td>23.740</td>
<td>None</td>
<td>SILVIA DID NOT THINK THAT HER GOOD CONDUCT WAS...</td>
<td>Sylvia.</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefano Staedt-Loss</td>
<td>1.5</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

<p>1000 rows × 8 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"vq-base.en-2d-4096c-cosine32-padfix-premlp-learnpos-5e-cleaned.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:45&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 6.64%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.230</td>
<td>None</td>
<td>AND OFTEN HAS MY MOTHER SAID WHILE ON HER LAP ...</td>
<td>And often has my mother said, while on her lap...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">377</td>
<td>3.910</td>
<td>None</td>
<td>HE WENT HERE THERE AND EVERYWHERE IN PERFECT C...</td>
<td>He went here, there, and everywhere in perfect...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">376</td>
<td>8.340</td>
<td>None</td>
<td>NEVER DID HE OBJECT TO BUCKLING UP HIS SUITCAS...</td>
<td>Never did he object to buckling up his suitcas...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">687</td>
<td>8.500</td>
<td>None</td>
<td>IF YOU DRESSED IN SILK AND GOLD FROM TOP TO TO...</td>
<td>If you dressed in silk and gold from top to to...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">688</td>
<td>11.125</td>
<td>None</td>
<td>TO SUCH PERSONS THESE INDIRECT MODES OF TRAINI...</td>
<td>To such persons, these indirect modes of train...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">918</td>
<td>3.000</td>
<td>None</td>
<td>THAT IS TRUE BADAUDERIE</td>
<td>That is true bad-dulch-gree.</td>
<td>0.750000</td>
<td>0.500000</td>
<td>0.625000</td>
<td>0.375000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">46</td>
<td>25.640</td>
<td>None</td>
<td>A GOOD NEIGHBOUR OF THE BRONTES A CLEVER INTEL...</td>
<td>A good neighbor of the Bronte's, a clever, int...</td>
<td>0.797101</td>
<td>0.785714</td>
<td>0.836957</td>
<td>0.163043</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">221</td>
<td>15.060</td>
<td>None</td>
<td>IN THE SHOOTING OF SHERIFF JONES IN LAWRENCE A...</td>
<td>In the shooting of Sheriff's</td>
<td>0.857143</td>
<td>0.857143</td>
<td>0.880952</td>
<td>0.119048</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">879</td>
<td>17.840</td>
<td>None</td>
<td>THEY KNEW NO NORTH NO SOUTH NO EAST NO WEST TH...</td>
<td>They knew no North.</td>
<td>0.925926</td>
<td>0.925926</td>
<td>0.925926</td>
<td>0.074074</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefano Staedalus.</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
</tr>
</tbody>
</table>

<p>1000 rows × 8 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>_9.plot.scatter(<span class="st">'secs'</span>, <span class="st">'wer'</span>, alpha<span class="op">=</span><span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Axes: xlabel='secs', ylabel='wer'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2C. Whisper quantization (semantic token) evaluation_files/figure-html/cell-56-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"vq-base.en-2d-4096c-cosine32-padfix-premlp-preconv-learnpos-5e-cleaned.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:36&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 6.34%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.230</td>
<td>None</td>
<td>AND OFTEN HAS MY MOTHER SAID WHILE ON HER LAP ...</td>
<td>And often has my mother said, while on her lap...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">696</td>
<td>18.415</td>
<td>None</td>
<td>FOR INSTANCE ONE DAY THE CHILDREN HAD BEEN PLA...</td>
<td>For instance, one day the children had been pl...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">370</td>
<td>2.340</td>
<td>None</td>
<td>BUT NOW NOTHING COULD HOLD ME BACK</td>
<td>But now nothing could hold me back.</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">369</td>
<td>9.340</td>
<td>None</td>
<td>I WANTED NOTHING MORE THAN TO SEE MY COUNTRY A...</td>
<td>I wanted nothing more than to see my country a...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">368</td>
<td>6.190</td>
<td>None</td>
<td>EVEN SO I HAD JUST RETURNED FROM AN ARDUOUS JO...</td>
<td>Even so, I had just returned from an arduous j...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">820</td>
<td>2.155</td>
<td>None</td>
<td>THE FORMER BOOLOOROO GROANED</td>
<td>the former Boula-Ri-Growned.</td>
<td>0.750000</td>
<td>0.600000</td>
<td>0.800000</td>
<td>0.200000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">843</td>
<td>2.110</td>
<td>None</td>
<td>FINE GLORIOUS</td>
<td>Find. Chlorious.</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>None</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cossay was my man's servant.</td>
<td>1.000000</td>
<td>0.666667</td>
<td>0.833333</td>
<td>0.166667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">592</td>
<td>1.805</td>
<td>None</td>
<td>HANS STIRS NOT</td>
<td>Hon Stir's Night.</td>
<td>1.333333</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefano Staedt-Loss</td>
<td>1.500000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
</tr>
</tbody>
</table>

<p>1000 rows × 8 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"vq-base.en-2d-4096c-cosine32-padfix-premlp-premean-learnpos-5e-cleaned-repro.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:30&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 10.00%
WER (w/o hallucinations): 10.00%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
<th data-quarto-table-cell-role="th">hallucination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">696</td>
<td>18.415</td>
<td>None</td>
<td>FOR INSTANCE ONE DAY THE CHILDREN HAD BEEN PLA...</td>
<td>For instance, one day the children had been pl...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">594</td>
<td>4.865</td>
<td>None</td>
<td>I REFER TO THE THERMOMETER IT INDICATES THE FI...</td>
<td>I refer to the thermometer, it indicates the f...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">738</td>
<td>8.105</td>
<td>None</td>
<td>THEN THERE WERE THREE OR FOUR LEADING MEN OF T...</td>
<td>Then there were three or four leading men of t...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">355</td>
<td>2.885</td>
<td>None</td>
<td>I'M AFRAID I DON'T KNOW MUCH ABOUT THE LAND OF OZ</td>
<td>I'm afraid I don't know much about the land of...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">354</td>
<td>9.840</td>
<td>None</td>
<td>I THINK THE NEXT GLASS CAT THE MAGICIAN MAKES ...</td>
<td>I think the next glass cat the magician makes ...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">886</td>
<td>22.095</td>
<td>None</td>
<td>THIS MEANT THAT FOR AN ALLEGED MISDEMEANOR FOR...</td>
<td>This is the end of the video.</td>
<td>0.949153</td>
<td>0.949153</td>
<td>0.978208</td>
<td>0.021792</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>None</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cossay was my man's servant.</td>
<td>1.000000</td>
<td>0.666667</td>
<td>0.833333</td>
<td>0.166667</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">85</td>
<td>2.610</td>
<td>None</td>
<td>THIS EVENING THEY ALL SAID</td>
<td>This is the end of the video.</td>
<td>1.200000</td>
<td>0.857143</td>
<td>0.971429</td>
<td>0.028571</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefano Staedt-Loss</td>
<td>1.500000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">418</td>
<td>17.640</td>
<td>None</td>
<td>FOR MANY THEN THIS BOOK HAS BEEN A SOURCE OF F...</td>
<td>For many then, this is the end of the video. F...</td>
<td>2.923077</td>
<td>0.942149</td>
<td>0.989616</td>
<td>0.010384</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>1000 rows × 9 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"vq-base.en-2d-4096c-cosine32-padfix-premlp-premean-learnpos-5e-cleaned-repro.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:28&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 7.82%
WER (w/o hallucinations): 7.82%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
<th data-quarto-table-cell-role="th">hallucination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">709</td>
<td>2.440</td>
<td>None</td>
<td>THE THREE MODES OF MANAGEMENT</td>
<td>the three modes of management.</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">740</td>
<td>2.715</td>
<td>None</td>
<td>BUT I MEAN TO HAVE MY INNINGS BEFORE LONG</td>
<td>But I mean to have my innings before long.</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">362</td>
<td>5.335</td>
<td>None</td>
<td>SOMETIMES IT IS CALLED A CRAZY QUILT BECAUSE T...</td>
<td>Sometimes it is called a crazy quilt because t...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">361</td>
<td>6.045</td>
<td>None</td>
<td>A BED QUILT MADE OF PATCHES OF DIFFERENT KINDS...</td>
<td>A bed quilt made of patches of different kinds...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">605</td>
<td>6.305</td>
<td>None</td>
<td>A SUFFOCATING SMELL OF NITROGEN FILLS THE AIR ...</td>
<td>A suffocating smell of nitrogen fills the air....</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">793</td>
<td>14.580</td>
<td>None</td>
<td>IN A SUNSET GLOWING OF CRIMSON AND GOLD SHE LI...</td>
<td>In a sunset</td>
<td>0.906250</td>
<td>0.906250</td>
<td>0.906250</td>
<td>0.093750</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">170</td>
<td>8.740</td>
<td>None</td>
<td>RUTH WAS GLAD TO HEAR THAT PHILIP HAD MADE A P...</td>
<td>Ruth was</td>
<td>0.931034</td>
<td>0.931034</td>
<td>0.931034</td>
<td>0.068966</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">818</td>
<td>9.870</td>
<td>None</td>
<td>I'LL GLADLY DO THAT PROMISED THE NEW BOOLOOROO...</td>
<td>I'll</td>
<td>0.933333</td>
<td>0.933333</td>
<td>0.933333</td>
<td>0.066667</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>None</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cosse was my man's servant.</td>
<td>1.000000</td>
<td>0.666667</td>
<td>0.833333</td>
<td>0.166667</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefano Staedt-Loss</td>
<td>1.500000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>1000 rows × 9 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"vq-base.en-2d-4096c-cosine32-padfix-premlp-premean-learnpos-5e-cleaned-repro-warm1000.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:36&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 7.23%
WER (w/o hallucinations): 7.23%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
<th data-quarto-table-cell-role="th">hallucination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">760</td>
<td>6.370</td>
<td>None</td>
<td>THERE CAME UPON ME A SUDDEN SHOCK WHEN I HEARD...</td>
<td>There came upon me a sudden shock when I heard...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">368</td>
<td>6.190</td>
<td>None</td>
<td>EVEN SO I HAD JUST RETURNED FROM AN ARDUOUS JO...</td>
<td>Even so, I had just returned from an arduous j...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">586</td>
<td>5.515</td>
<td>None</td>
<td>THERE'S A HEAVY STORM COMING ON I CRIED POINTI...</td>
<td>There's a heavy storm coming on, I cried, poin...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">366</td>
<td>3.615</td>
<td>None</td>
<td>CHAPTER THREE AS MASTER WISHES</td>
<td>Chapter 3 As Master Wishes</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">365</td>
<td>5.780</td>
<td>None</td>
<td>I WILL SHOW YOU WHAT A GOOD JOB I DID AND SHE ...</td>
<td>I will show you what a good job I did, and she...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">694</td>
<td>5.965</td>
<td>None</td>
<td>I EXPECT YOU HAVE BEEN A VERY GOOD GIRL ANDELL...</td>
<td>I</td>
<td>0.933333</td>
<td>0.933333</td>
<td>0.933333</td>
<td>0.066667</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">881</td>
<td>13.950</td>
<td>None</td>
<td>WE BELIEVE IN A LITERAL RESURRECTION AND AN AC...</td>
<td>We believe that we are the most important ones.</td>
<td>0.944444</td>
<td>0.944444</td>
<td>0.987654</td>
<td>0.012346</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">106</td>
<td>2.020</td>
<td>None</td>
<td>SQUEAK SQUEAK</td>
<td>Quick, quick!</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>None</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cossay was my man's servant.</td>
<td>1.000000</td>
<td>0.666667</td>
<td>0.833333</td>
<td>0.166667</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefano's dead loss.</td>
<td>2.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>1000 rows × 9 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"vq-base.en-2d-4096c-cosine32-padfix-premlp-premean-learnpos-5e-cleaned-repro-warm1000-2.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:35&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 6.47%
WER (w/o hallucinations): 6.47%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
<th data-quarto-table-cell-role="th">hallucination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.230</td>
<td>None</td>
<td>AND OFTEN HAS MY MOTHER SAID WHILE ON HER LAP ...</td>
<td>And often has my mother said, while on her lap...</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">702</td>
<td>14.175</td>
<td>None</td>
<td>AND THIS METHOD OF TREATING THE CASE WAS MUCH ...</td>
<td>And this method of treating the case was much ...</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">703</td>
<td>4.775</td>
<td>None</td>
<td>NATURE OF THE EFFECT PRODUCED BY EARLY IMPRESS...</td>
<td>Nature of the Effect produced by Early Impress...</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">377</td>
<td>3.910</td>
<td>None</td>
<td>HE WENT HERE THERE AND EVERYWHERE IN PERFECT C...</td>
<td>He went here, there, and everywhere in perfect...</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">376</td>
<td>8.340</td>
<td>None</td>
<td>NEVER DID HE OBJECT TO BUCKLING UP HIS SUITCAS...</td>
<td>Never did he object to buckling up his suitcas...</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>None</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cossé was my man's servant.</td>
<td>1.0</td>
<td>0.666667</td>
<td>0.833333</td>
<td>0.166667</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">322</td>
<td>3.200</td>
<td>None</td>
<td>I NOW USE THEM AS ORNAMENTAL STATUARY IN MY GA...</td>
<td>and</td>
<td>1.0</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">652</td>
<td>3.475</td>
<td>None</td>
<td>I AM SO VERY TIRED OF BEING ALL ALONE HERE</td>
<td>and</td>
<td>1.0</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">555</td>
<td>5.815</td>
<td>None</td>
<td>BUT THE DUSK DEEPENING IN THE SCHOOLROOM COVER...</td>
<td>and</td>
<td>1.0</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Staphano's dead loss.</td>
<td>2.0</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>1000 rows × 9 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"vq-base.en-2d-4096c-cosine32-padfix-premlp-premean-learnpos-5e-cleaned.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:33&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 5.93%
WER (w/o hallucinations): 5.93%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
<th data-quarto-table-cell-role="th">hallucination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">781</td>
<td>3.050</td>
<td>None</td>
<td>WHEN DO YOU INTEND THAT THE JOHN BRIGHT SHALL ...</td>
<td>When do you intend that the John Bright shall ...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">388</td>
<td>2.355</td>
<td>None</td>
<td>WE'RE LEAVING ON THE ABRAHAM LINCOLN</td>
<td>We're leaving on the Abraham Lincoln.</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">387</td>
<td>2.735</td>
<td>None</td>
<td>A ROUTE SLIGHTLY LESS DIRECT THAT'S ALL</td>
<td>a route slightly less direct. That's all.</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">386</td>
<td>5.915</td>
<td>None</td>
<td>YES WE ARE CERTAINLY I REPLIED EVASIVELY BUT A...</td>
<td>Yes, we are. Certainly, I replied evasively, b...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">385</td>
<td>4.530</td>
<td>None</td>
<td>ANYHOW WE'LL LEAVE INSTRUCTIONS TO SHIP THE WH...</td>
<td>Anyhow, we'll leave instructions to ship the w...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">524</td>
<td>3.195</td>
<td>None</td>
<td>BROTHER MAC ARDLE BROTHER KEOGH</td>
<td>Brother McCarle, Brother Kioff.</td>
<td>0.600000</td>
<td>0.600000</td>
<td>0.800000</td>
<td>0.200000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">592</td>
<td>1.805</td>
<td>None</td>
<td>HANS STIRS NOT</td>
<td>Hans-Stirrsnacht.</td>
<td>0.666667</td>
<td>0.666667</td>
<td>0.833333</td>
<td>0.166667</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">766</td>
<td>2.540</td>
<td>None</td>
<td>YOU PROPOSE TO KIDNAP ME I SAID</td>
<td>You proposed a kenatmi set.</td>
<td>0.857143</td>
<td>0.857143</td>
<td>0.971429</td>
<td>0.028571</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Steffano Staedalus</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>None</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cossay was my man's servant.</td>
<td>1.000000</td>
<td>0.666667</td>
<td>0.833333</td>
<td>0.166667</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>1000 rows × 9 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> _14.plot.scatter(<span class="st">'secs'</span>, <span class="st">'wer'</span>, alpha<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">0</span>, <span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(0.0, 1.5)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2C. Whisper quantization (semantic token) evaluation_files/figure-html/cell-63-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"vq-base.en-2d-4096c-60k.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:30&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 9.34%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">646</td>
<td>3.385</td>
<td>None</td>
<td>I ALMOST THINK I CAN REMEMBER FEELING A LITTLE...</td>
<td>I almost think I can remember feeling a little...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">862</td>
<td>6.720</td>
<td>None</td>
<td>TO THE FERVENT LATTER DAY SAINT A TEMPLE IS NO...</td>
<td>To the fervent Latter-day Saint, a temple is n...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">370</td>
<td>2.340</td>
<td>None</td>
<td>BUT NOW NOTHING COULD HOLD ME BACK</td>
<td>But now nothing could hold me back.</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">369</td>
<td>9.340</td>
<td>None</td>
<td>I WANTED NOTHING MORE THAN TO SEE MY COUNTRY A...</td>
<td>I wanted nothing more than to see my country a...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">368</td>
<td>6.190</td>
<td>None</td>
<td>EVEN SO I HAD JUST RETURNED FROM AN ARDUOUS JO...</td>
<td>Even so, I had just returned from an arduous j...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">61</td>
<td>10.250</td>
<td>None</td>
<td>IN WINTER WHEN THE SNOW LAY GLITTERING ON THE ...</td>
<td>In winter, when the snow lay glittering on the...</td>
<td>1.791667</td>
<td>0.651515</td>
<td>0.666035</td>
<td>0.333965</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">468</td>
<td>12.250</td>
<td>None</td>
<td>I HAVE GREAT THINGS TO TELL YOU SENOR SAID DON...</td>
<td>I have great things to tell you, Senor, sadona...</td>
<td>1.861111</td>
<td>0.676768</td>
<td>0.712682</td>
<td>0.287318</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">558</td>
<td>15.720</td>
<td>None</td>
<td>IT WAS STRANGE TOO THAT HE FOUND AN ARID PLEAS...</td>
<td>It was strange, too, that he found an arid ple...</td>
<td>2.317073</td>
<td>0.698529</td>
<td>0.698529</td>
<td>0.301471</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">770</td>
<td>13.960</td>
<td>None</td>
<td>WHAT WORLD WIDE INIQUITY SUCH A SPEECH AS THAT...</td>
<td>What worldwide iniquity such a speech as that ...</td>
<td>2.375000</td>
<td>0.719697</td>
<td>0.738740</td>
<td>0.261260</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">444</td>
<td>12.475</td>
<td>None</td>
<td>THEY DREW THEIR SWORDS HID THEIR FACES IN THE ...</td>
<td>They drew their swords, hid their faces in the...</td>
<td>4.200000</td>
<td>0.807692</td>
<td>0.807692</td>
<td>0.192308</td>
</tr>
</tbody>
</table>

<p>1000 rows × 8 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"vq-base.en-2d-4096c-cosine32-padfix-premlp-premean-learnpos-5e-cleaned-eqvad.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:38&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 7.47%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.230</td>
<td>None</td>
<td>AND OFTEN HAS MY MOTHER SAID WHILE ON HER LAP ...</td>
<td>And often has my mother said, while on her lap...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">673</td>
<td>12.130</td>
<td>None</td>
<td>THE PRINCESS CERTAINLY WAS BEAUTIFUL AND HE WO...</td>
<td>The princess certainly was beautiful, and he w...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">674</td>
<td>2.295</td>
<td>None</td>
<td>HE ONLY SHOOK HIS HEAD</td>
<td>He only shook his head.</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">355</td>
<td>2.885</td>
<td>None</td>
<td>I'M AFRAID I DON'T KNOW MUCH ABOUT THE LAND OF OZ</td>
<td>I'm afraid I don't know much about the land of...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">353</td>
<td>5.870</td>
<td>None</td>
<td>THE FIRST LOT WE TESTED ON OUR GLASS CAT WHICH...</td>
<td>The first lot we tested on our glass cat, whic...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>None</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cossay was my man's servant.</td>
<td>1.000000</td>
<td>0.666667</td>
<td>0.833333</td>
<td>0.166667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefano Stettelos.</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">592</td>
<td>1.805</td>
<td>None</td>
<td>HANS STIRS NOT</td>
<td>Honsters, nod.</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">146</td>
<td>3.260</td>
<td>None</td>
<td>WHERE THEE AND THY FAMILY ARE KNOWN</td>
<td>Where's D and I-F where's D and I-F are known?</td>
<td>1.428571</td>
<td>0.714286</td>
<td>0.836735</td>
<td>0.163265</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">996</td>
<td>19.915</td>
<td>None</td>
<td>EDISON HAD INSTALLED HIS HISTORIC FIRST GREAT ...</td>
<td>Edison had installed his historic first-grade ...</td>
<td>3.208333</td>
<td>0.766169</td>
<td>0.771041</td>
<td>0.228959</td>
</tr>
</tbody>
</table>

<p>1000 rows × 8 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> _8.plot.scatter(<span class="st">'secs'</span>, <span class="st">'wer'</span>, alpha<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">0</span>, <span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(0.0, 1.5)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2C. Whisper quantization (semantic token) evaluation_files/figure-html/cell-66-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> _15[<span class="st">'secs'</span>].hist()</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>ax.set_yscale(<span class="st">'log'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2C. Whisper quantization (semantic token) evaluation_files/figure-html/cell-67-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>plt.plot(_15[<span class="st">'secs'</span>], <span class="dv">1</span><span class="op">/</span>_15[<span class="st">'gt_text'</span>].<span class="bu">str</span>.split(<span class="st">'\w+'</span>).<span class="bu">str</span>.<span class="bu">len</span>(), <span class="st">'.'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2C. Whisper quantization (semantic token) evaluation_files/figure-html/cell-68-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the reproducibility got pretty low ;)</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>):</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(i)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>    test_model(<span class="ss">f"test-run-</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">.model"</span>)</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0
WER: 6.37%
WER (w/o hallucinations): 6.37%

1
WER: 10.69%
WER (w/o hallucinations): 9.89%

2
WER: 12.34%
WER (w/o hallucinations): 11.79%

3
WER: 15.83%
WER (w/o hallucinations): 15.30%
</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:33&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:28&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:34&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:31&lt;00:00]
    </div>
    
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"test-run-warm1000.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:31&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 8.81%
WER (w/o hallucinations): 8.81%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
<th data-quarto-table-cell-role="th">hallucination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.230</td>
<td>None</td>
<td>AND OFTEN HAS MY MOTHER SAID WHILE ON HER LAP ...</td>
<td>And often has my mother said, while on her lap...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">368</td>
<td>6.190</td>
<td>None</td>
<td>EVEN SO I HAD JUST RETURNED FROM AN ARDUOUS JO...</td>
<td>Even so, I had just returned from an arduous j...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">691</td>
<td>4.985</td>
<td>None</td>
<td>TO GIVE AN IDEA OF THESE CONVERSATIONS I WILL ...</td>
<td>To give an idea of these conversations, I will...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">366</td>
<td>3.615</td>
<td>None</td>
<td>CHAPTER THREE AS MASTER WISHES</td>
<td>Chapter 3 As Master Wishes</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">365</td>
<td>5.780</td>
<td>None</td>
<td>I WILL SHOW YOU WHAT A GOOD JOB I DID AND SHE ...</td>
<td>I will show you what a good job I did, and she...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">792</td>
<td>1.810</td>
<td>None</td>
<td>VENICE</td>
<td>VINIS.</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">324</td>
<td>2.700</td>
<td>None</td>
<td>ASKED THE VOICE IN SCORNFUL ACCENTS</td>
<td>Ask the voice in the voice in the voice in the...</td>
<td>1.500000</td>
<td>0.750000</td>
<td>0.875000</td>
<td>0.125000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefano's dead loss.</td>
<td>2.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26</td>
<td>16.735</td>
<td>None</td>
<td>P S PRAY SIR EXCUSE ME FOR WRITING TO YOU A SE...</td>
<td>P-S-P-S-P-S-P-S-P-S-P-S-P-S-P-S-P-S-P-S-P-S-P-...</td>
<td>2.037037</td>
<td>0.982143</td>
<td>0.999339</td>
<td>0.000661</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">106</td>
<td>2.020</td>
<td>None</td>
<td>SQUEAK SQUEAK</td>
<td>In the past, we have a question.</td>
<td>3.500000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>1000 rows × 9 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"test-run-1e.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:34&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 8.41%
WER (w/o hallucinations): 8.05%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
<th data-quarto-table-cell-role="th">hallucination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.230</td>
<td>None</td>
<td>AND OFTEN HAS MY MOTHER SAID WHILE ON HER LAP ...</td>
<td>And often has my mother said, while on her lap...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">655</td>
<td>4.895</td>
<td>None</td>
<td>I SHALL BE PUNISHED FOR IT NOW I SUPPOSE BY BE...</td>
<td>I shall be punished for it now, I suppose, by ...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">657</td>
<td>3.640</td>
<td>None</td>
<td>I AM VERY TIRED OF SWIMMING ABOUT HERE O MOUSE</td>
<td>I am very tired of swimming about here, oh mouse.</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">318</td>
<td>5.115</td>
<td>None</td>
<td>MOST PEOPLE TALK TOO MUCH SO IT IS A RELIEF TO...</td>
<td>Most people talk too much, so it is a relief t...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">317</td>
<td>7.920</td>
<td>None</td>
<td>HE SELECTED A SMALL GOLD BOTTLE WITH A PEPPER ...</td>
<td>He selected a small gold bottle with a pepper ...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">549</td>
<td>10.575</td>
<td>None</td>
<td>AT MOST BY AN ALMS GIVEN TO A BEGGAR WHOSE BLE...</td>
<td>At most, by an alms given to a beggar whose bl...</td>
<td>1.000000</td>
<td>0.500000</td>
<td>0.500000</td>
<td>0.500000</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">399</td>
<td>6.365</td>
<td>None</td>
<td>I WAS WELL SATISFIED WITH MY CABIN WHICH WAS L...</td>
<td>I was well satisfied with my cabin, which was ...</td>
<td>1.052632</td>
<td>0.540541</td>
<td>0.588905</td>
<td>0.411095</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Steffinor's Daedalus.</td>
<td>1.500000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">659</td>
<td>4.995</td>
<td>None</td>
<td>WE WON'T TALK ABOUT HER ANY MORE IF YOU'D RATH...</td>
<td>We won't talk about her anymore if he'd rather...</td>
<td>1.866667</td>
<td>0.700000</td>
<td>0.760000</td>
<td>0.240000</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">95</td>
<td>8.800</td>
<td>None</td>
<td>THOUGHT THE FIR TREE AND BELIEVED IT ALL BECAU...</td>
<td>thought the fur tree, and believed it all, bec...</td>
<td>4.619048</td>
<td>0.829060</td>
<td>0.837200</td>
<td>0.162800</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>1000 rows × 9 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># but it got better after some hyperparam tuning</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"vqmodel-4e-6454-hyptuned.model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:30&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 7.71%
WER (w/o hallucinations): 7.71%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
<th data-quarto-table-cell-role="th">hallucination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">403</td>
<td>5.370</td>
<td>None</td>
<td>DEPARTING FROM FIVE HUNDRED THOUSAND THROATS T...</td>
<td>Departing from 500,000 throats, three cheers b...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">922</td>
<td>4.400</td>
<td>None</td>
<td>BUT HOW DID SHE MANAGE TO RENDER IT SO FASHION...</td>
<td>But how did she manage to render it so fashion...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">629</td>
<td>3.235</td>
<td>None</td>
<td>TWO HOURS AFTERWARDS A TERRIBLE SHOCK AWOKE ME</td>
<td>Two hours afterwards, a terrible shock, awoke me.</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">355</td>
<td>2.885</td>
<td>None</td>
<td>I'M AFRAID I DON'T KNOW MUCH ABOUT THE LAND OF OZ</td>
<td>I'm afraid I don't know much about the land of...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">353</td>
<td>5.870</td>
<td>None</td>
<td>THE FIRST LOT WE TESTED ON OUR GLASS CAT WHICH...</td>
<td>The first lot we tested on our glass cat, whic...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">849</td>
<td>3.560</td>
<td>None</td>
<td>I HAD A NOTION IT WAS YOU MATE AS SAVED ME FRO...</td>
<td>I'll have a note.</td>
<td>0.928571</td>
<td>0.866667</td>
<td>0.942857</td>
<td>0.057143</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">741</td>
<td>16.360</td>
<td>None</td>
<td>OF WHAT MISSUS NEVERBEND HAD GONE THROUGH IN P...</td>
<td>Of what Mrs. N N N N N N N N N N N N N N N N N...</td>
<td>0.936170</td>
<td>0.936170</td>
<td>0.992021</td>
<td>0.007979</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>None</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Casa was my man's servant.</td>
<td>1.000000</td>
<td>0.666667</td>
<td>0.833333</td>
<td>0.166667</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefano Stetelos.</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">592</td>
<td>1.805</td>
<td>None</td>
<td>HANS STIRS NOT</td>
<td>Hon Stur's Night.</td>
<td>1.333333</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>1000 rows × 9 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"vqmodel-4e-6454-hyptuned-small.en.model"</span>, N<span class="op">=</span><span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:41&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 7.38%
WER (w/o hallucinations): 7.38%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
<th data-quarto-table-cell-role="th">hallucination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.230</td>
<td>None</td>
<td>AND OFTEN HAS MY MOTHER SAID WHILE ON HER LAP ...</td>
<td>And often has my mother said, while on her lap...</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">350</td>
<td>10.680</td>
<td>None</td>
<td>AT ONE END STOOD A GREAT FIREPLACE IN WHICH A ...</td>
<td>At one end stood a great fireplace, in which a...</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">349</td>
<td>2.130</td>
<td>None</td>
<td>THE WOMAN SEEMED THOUGHTFUL</td>
<td>The woman seemed thoughtful.</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">680</td>
<td>6.450</td>
<td>None</td>
<td>HE DARTED LIKE AN ARROW THROUGH ALL THE HALLS ...</td>
<td>He darted like an arrow through all the halls,...</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">347</td>
<td>3.665</td>
<td>None</td>
<td>OJO HAD NEVER EATEN SUCH A FINE MEAL IN ALL HI...</td>
<td>Ojo had never eaten such a fine meal in all hi...</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">592</td>
<td>1.805</td>
<td>None</td>
<td>HANS STIRS NOT</td>
<td>Honsters, Nod.</td>
<td>1.00000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">792</td>
<td>1.810</td>
<td>None</td>
<td>VENICE</td>
<td>VINUS.</td>
<td>1.00000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>None</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cossay was my man's servant.</td>
<td>1.00000</td>
<td>0.666667</td>
<td>0.833333</td>
<td>0.166667</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Stephenos dead loss.</td>
<td>1.50000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">440</td>
<td>15.770</td>
<td>None</td>
<td>ELEVEN O'CLOCK HAD STRUCK IT WAS A FINE CLEAR ...</td>
<td>At the time of the day, the morning of the day...</td>
<td>4.12766</td>
<td>0.960396</td>
<td>0.993259</td>
<td>0.006741</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>1000 rows × 9 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"vqmodel-4e-hyptuned-16gpu.model"</span>, N<span class="op">=</span><span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:32&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 6.01%
WER (w/o hallucinations): 6.01%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
<th data-quarto-table-cell-role="th">hallucination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.230</td>
<td>None</td>
<td>AND OFTEN HAS MY MOTHER SAID WHILE ON HER LAP ...</td>
<td>And often has my mother said, while on her lap...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">390</td>
<td>1.975</td>
<td>None</td>
<td>WE DON'T KNOW WHERE IT WILL TAKE US</td>
<td>We don't know where it will take us.</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">708</td>
<td>13.020</td>
<td>None</td>
<td>THE PAIN PRODUCED BY AN ACT OF HASTY AND ANGRY...</td>
<td>The pain produced by an act of hasty and angry...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">388</td>
<td>2.355</td>
<td>None</td>
<td>WE'RE LEAVING ON THE ABRAHAM LINCOLN</td>
<td>We're leaving on the Abraham Lincoln.</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">387</td>
<td>2.735</td>
<td>None</td>
<td>A ROUTE SLIGHTLY LESS DIRECT THAT'S ALL</td>
<td>A route slightly less direct, that's all.</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">918</td>
<td>3.000</td>
<td>None</td>
<td>THAT IS TRUE BADAUDERIE</td>
<td>That is true, bad old gree.</td>
<td>0.750000</td>
<td>0.500000</td>
<td>0.625000</td>
<td>0.375000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">809</td>
<td>8.875</td>
<td>None</td>
<td>WHEN THE BLUESKINS SAW GHIP GHISIZZLE THEY RAI...</td>
<td>Thanks for watching!</td>
<td>0.961538</td>
<td>0.961538</td>
<td>0.987179</td>
<td>0.012821</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">643</td>
<td>12.020</td>
<td>None</td>
<td>ALICE TOOK UP THE FAN AND GLOVES AND AS THE HA...</td>
<td>Thank you.</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>None</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cosse was my man's servant.</td>
<td>1.000000</td>
<td>0.666667</td>
<td>0.833333</td>
<td>0.166667</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefanos de los</td>
<td>1.500000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>1000 rows × 9 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"vqmodel-4e-hyptuned-32gpu.model"</span>, N<span class="op">=</span><span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:32&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 5.94%
WER (w/o hallucinations): 5.94%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
<th data-quarto-table-cell-role="th">hallucination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">757</td>
<td>10.030</td>
<td>None</td>
<td>THEREFORE I FEEL MYSELF QUITE ABLE AS PRESIDEN...</td>
<td>Therefore, I feel myself quite able, as Presid...</td>
<td>0.00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">628</td>
<td>2.550</td>
<td>None</td>
<td>DURING HIS WATCH I SLEPT</td>
<td>During his watch, I slept.</td>
<td>0.00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">756</td>
<td>4.735</td>
<td>None</td>
<td>YOU HAVE COME TO US THREATENING US WITH ABSOLU...</td>
<td>You have come to us threatening us with absolu...</td>
<td>0.00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">377</td>
<td>3.910</td>
<td>None</td>
<td>HE WENT HERE THERE AND EVERYWHERE IN PERFECT C...</td>
<td>He went here, there, and everywhere in perfect...</td>
<td>0.00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">376</td>
<td>8.340</td>
<td>None</td>
<td>NEVER DID HE OBJECT TO BUCKLING UP HIS SUITCAS...</td>
<td>Never did he object to buckling up his suitcas...</td>
<td>0.00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">918</td>
<td>3.000</td>
<td>None</td>
<td>THAT IS TRUE BADAUDERIE</td>
<td>That is true bad-delt gree.</td>
<td>0.75</td>
<td>0.500000</td>
<td>0.625000</td>
<td>0.375000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>None</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cossay was my man's servant.</td>
<td>1.00</td>
<td>0.666667</td>
<td>0.833333</td>
<td>0.166667</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">592</td>
<td>1.805</td>
<td>None</td>
<td>HANS STIRS NOT</td>
<td>Honsters Nied.</td>
<td>1.00</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">819</td>
<td>5.775</td>
<td>None</td>
<td>SCUSE ME SAID TROT I NEGLECTED TO TELL YOU THA...</td>
<td>Thanks for watching.</td>
<td>1.00</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefano Staedt-Loss</td>
<td>1.50</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>1000 rows × 9 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"vqmodel-512c-4e-hyptuned-32gpu.model"</span>, N<span class="op">=</span><span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 08:52&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 7.37%
WER (w/o hallucinations): 7.37%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
<th data-quarto-table-cell-role="th">hallucination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">715</td>
<td>11.340</td>
<td>None</td>
<td>THE MOTHER IN MANAGING THE CASE IN THIS WAY RE...</td>
<td>The mother, in managing the case in this way, ...</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">347</td>
<td>3.665</td>
<td>None</td>
<td>OJO HAD NEVER EATEN SUCH A FINE MEAL IN ALL HI...</td>
<td>Ojo had never eaten such a fine meal in all hi...</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">860</td>
<td>10.555</td>
<td>None</td>
<td>IT IS NOTABLE THAT THE INDIAN TRIBES HAVE GENE...</td>
<td>It is notable that the Indian tribes have gene...</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">608</td>
<td>3.070</td>
<td>None</td>
<td>THE HORIZON SEEMS EXTREMELY DISTANT</td>
<td>The horizon seems extremely distant.</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">344</td>
<td>4.275</td>
<td>None</td>
<td>I AM MY DEAR AND ALL STRANGERS ARE WELCOME TO ...</td>
<td>I am, my dear, and all strangers are welcome t...</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>None</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cosay was my man's servant.</td>
<td>1.0</td>
<td>0.666667</td>
<td>0.833333</td>
<td>0.166667</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">260</td>
<td>3.155</td>
<td>None</td>
<td>WHO TAUGHT YOU TO SCRUB A FLOOR I SHOULD LIKE ...</td>
<td>.</td>
<td>1.0</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">592</td>
<td>1.805</td>
<td>None</td>
<td>HANS STIRS NOT</td>
<td>Honster's Night.</td>
<td>1.0</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">792</td>
<td>1.810</td>
<td>None</td>
<td>VENICE</td>
<td>Venus.</td>
<td>1.0</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefanos de los.</td>
<td>1.5</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>1000 rows × 9 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>test_model(<span class="st">"vqmodel-512c-dim64-4e-hyptuned-32gpu.model"</span>, N<span class="op">=</span><span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="1000" class="" max="1000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [1000/1000 01:29&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WER: 7.13%
WER (w/o hallucinations): 7.13%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secs</th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">gt_text</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">wer</th>
<th data-quarto-table-cell-role="th">mer</th>
<th data-quarto-table-cell-role="th">wil</th>
<th data-quarto-table-cell-role="th">wip</th>
<th data-quarto-table-cell-role="th">hallucination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.230</td>
<td>None</td>
<td>AND OFTEN HAS MY MOTHER SAID WHILE ON HER LAP ...</td>
<td>And often has my mother said, while on her lap...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">680</td>
<td>6.450</td>
<td>None</td>
<td>HE DARTED LIKE AN ARROW THROUGH ALL THE HALLS ...</td>
<td>He darted like an arrow through all the halls,...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">682</td>
<td>5.145</td>
<td>None</td>
<td>AND ALL HIS BROTHERS AND SISTERS STOOD ROUND A...</td>
<td>and all his brothers and sisters stood round a...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">684</td>
<td>2.165</td>
<td>None</td>
<td>ANDERS FACE GREW RED</td>
<td>Anders face grew red.</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">685</td>
<td>2.775</td>
<td>None</td>
<td>BUT HIS MOTHER HUGGED HIM CLOSE</td>
<td>But his mother hugged him close.</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">106</td>
<td>2.020</td>
<td>None</td>
<td>SQUEAK SQUEAK</td>
<td>Speak, speak.</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">371</td>
<td>2.440</td>
<td>None</td>
<td>CONSEIL WAS MY MANSERVANT</td>
<td>Cossay was my man's servant.</td>
<td>1.000000</td>
<td>0.666667</td>
<td>0.833333</td>
<td>0.166667</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">592</td>
<td>1.805</td>
<td>None</td>
<td>HANS STIRS NOT</td>
<td>Honsters, Nied.</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">336</td>
<td>4.835</td>
<td>None</td>
<td>FOR A LONG TIME HE HAD WISHED TO EXPLORE THE B...</td>
<td>For a long time, you can see that the video is...</td>
<td>1.333333</td>
<td>0.800000</td>
<td>0.933333</td>
<td>0.066667</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">538</td>
<td>2.215</td>
<td>None</td>
<td>STEPHANOS DEDALOS</td>
<td>Stefano Staedt-Loss</td>
<td>1.500000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>1000 rows × 9 columns</p>
</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>